<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CAD Code Solutions</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            overflow-x: hidden;
        }
        nav {
            background-color: #333;
            display: flex;
            justify-content: center;
            padding: 20px;
            position: fixed;
            width: 100%;
            top: 0;
            left: 0;
            z-index: 1000;
        }
        nav a {
            color: white;
            padding: 10px 20px;
            text-decoration: none;
        }
        nav a:hover {
            background-color: #555;
        }
        .container {
            padding-top: 80px; /* Adjust based on nav height */
            padding: 20px;
            box-sizing: border-box;
            flex: 1;
        }
        .code {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            background-color: #f9f9f9;
            box-sizing: border-box;
            text-align: center;
            min-height: 100vh;
        }
        .code h2 {
            margin-bottom: 20px;
        }
        .code p {
            max-width: 800px;
            margin-bottom: 20px;
        }
        .code .code-example {
            width: 80%;
            background-color: #f0f0f0;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            padding: 20px;
            text-align: left;
        }
        footer {
            background-color: #333;
            color: white;
            text-align: center;
            padding: 10px;
            flex-shrink: 0;
        }
    </style>
</head>
<body>
    <nav>
        <a href="revit.html">Revit</a>
        <a href="cad.html">CAD</a>
        <a href="projects.html">Projects</a>
        <a href="charity.html">Charity</a>
    </nav>
    <div class="container" id="cad">
        <div class="code">
            <h2>CAD Code Solutions</h2>
            <p>Here, I offer free CAD code snippets to help solve common problems. Feel free to use and adapt these in your own projects:</p>
            <div class="code-example">
                <h3>Code Example 1: Batch processing files</h3>
                <pre>
                    from pyautocad import Autocad, APoint
                    import os
                    
                    # Define the directory containing the AutoCAD files
                    dwg_directory = "path/to/your/dwg/files"
                    
                    # Initialize AutoCAD
                    acad = Autocad(create_if_not_exists=True)
                    print(f"AutoCAD running: {acad.app}")
                    
                    # Function to change layer of all objects to 'Layer1'
                    def change_layer(doc, new_layer):
                        for obj in doc.ModelSpace:
                            obj.Layer = new_layer
                    
                    # Iterate through all DWG files in the specified directory
                    for filename in os.listdir(dwg_directory):
                        if filename.endswith(".dwg"):
                            file_path = os.path.join(dwg_directory, filename)
                            print(f"Processing file: {file_path}")
                    
                            # Open the DWG file
                            acad.app.Documents.Open(file_path)
                    
                            # Get the active document
                            doc = acad.app.ActiveDocument
                    
                            # Apply the layer change function
                            change_layer(doc, "Layer1")
                    
                            # Save and close the document
                            doc.Save()
                            doc.Close()
                    
                    print("Batch processing completed.")
                    
                </pre>
                <p>This snippet demonstrates a simple greeting function in CAD's scripting environment.</p>
            </div>
            <div class="code-example">
                <h3>Code Example 2: Renaming Layers</h3>
                <pre>
                    from pyautocad import Autocad, APoint
                    import os
                    
                    # Define the directory containing the AutoCAD files
                    dwg_directory = "path/to/your/dwg/files"
                    
                    # Define the layer renaming convention
                    # Example: {"OldLayerName1": "NewLayerName1", "OldLayerName2": "NewLayerName2"}
                    layer_rename_mapping = {
                        "OldLayer1": "NewLayer1",
                        "OldLayer2": "NewLayer2",
                        # Add more mappings as needed
                    }
                    
                    # Initialize AutoCAD
                    acad = Autocad(create_if_not_exists=True)
                    print(f"AutoCAD running: {acad.app}")
                    
                    # Function to rename layers based on the given mapping
                    def rename_layers(doc, rename_mapping):
                        for layer in doc.Layers:
                            old_name = layer.Name
                            if old_name in rename_mapping:
                                new_name = rename_mapping[old_name]
                                print(f"Renaming layer '{old_name}' to '{new_name}'")
                                layer.Name = new_name
                    
                    # Iterate through all DWG files in the specified directory
                    for filename in os.listdir(dwg_directory):
                        if filename.endswith(".dwg"):
                            file_path = os.path.join(dwg_directory, filename)
                            print(f"Processing file: {file_path}")
                    
                            # Open the DWG file
                            acad.app.Documents.Open(file_path)
                    
                            # Get the active document
                            doc = acad.app.ActiveDocument
                    
                            # Apply the layer renaming function
                            rename_layers(doc, layer_rename_mapping)
                    
                            # Save and close the document
                            doc.Save()
                            doc.Close()
                    
                    print("Batch renaming of layers completed.")
                    
                </pre>
                <p>This snippet shows a basic increment function in CAD's scripting environment.</p>
            </div>
            <!-- Add more CAD code examples as needed -->
        </div>
    </div>
    <footer>
        <p>&copy; 2024 Your Name. All rights reserved.</p>
    </footer>
</body>
</html>
